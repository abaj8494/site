+++
title = "Machine Learning on the M1 Macbook Pro"
+++

This page just contains some benchmarking metrics for the 2020 M1 Macbook Pro 8GB:

[[m1.png]]

#+BEGIN_SRC sh
~/Code/STREAM/stream
#+END_SRC

[[https://github.com/jeffhammond/STREAM][STREAM]]
#+CAPTION: STREAM output
#+BEGIN_SRC
#+RESULTS:
| ------------------------------------------------------------- |            |                       |          |             |        |            |               |            |            |               |
| STREAM                                                        | version    | $Revision:            | 5.1      | $           |        |            |               |            |            |               |
| ------------------------------------------------------------- |            |                       |          |             |        |            |               |            |            |               |
| This                                                          | system     | uses                  | 8        | bytes       | per    | array      | element.      |            |            |               |
| ------------------------------------------------------------- |            |                       |          |             |        |            |               |            |            |               |
| Array                                                         | size       | =                     | 10000000 | (elements), | Offset | =          | 0             | (elements) |            |               |
| Memory                                                        | per        | array                 | =        | 76.3        | MiB    | (=         | 0.1           | GiB).      |            |               |
| Total                                                         | memory     | required              | =        | 228.9       | MiB    | (=         | 0.2           | GiB).      |            |               |
| Each                                                          | kernel     | will                  | be       | executed    | 10     | times.     |               |            |            |               |
| The                                                           | *best*     | time                  | for      | each        | kernel | (excluding | the           | first      | iteration) |               |
| will                                                          | be         | used                  | to       | compute     | the    | reported   | bandwidth.    |            |            |               |
| ------------------------------------------------------------- |            |                       |          |             |        |            |               |            |            |               |
| Your                                                          | clock      | granularity/precision | appears  | to          | be     | 1          | microseconds. |            |            |               |
| Each                                                          | test       | below                 | will     | take        | on     | the        | order         | of         | 14700      | microseconds. |
| (=                                                            | 14700      | clock                 | ticks)   |             |        |            |               |            |            |               |
| Increase                                                      | the        | size                  | of       | the         | arrays | if         | this          | shows      | that       |               |
| you                                                           | are        | not                   | getting  | at          | least  | 20         | clock         | ticks      | per        | test.         |
| ------------------------------------------------------------- |            |                       |          |             |        |            |               |            |            |               |
| WARNING                                                       | --         | The                   | above    | is          | only   | a          | rough         | guideline. |            |               |
| For                                                           | best       | results,              | please   | be          | sure   | you        | know          | the        |            |               |
| precision                                                     | of         | your                  | system   | timer.      |        |            |               |            |            |               |
| ------------------------------------------------------------- |            |                       |          |             |        |            |               |            |            |               |
| Function                                                      | Best       | Rate                  | MB/s     | Avg         | time   | Min        | time          | Max        | time       |               |
| Copy:                                                         | 60721.0    | 0.002672              | 0.002635 | 0.002711    |        |            |               |            |            |               |
| Scale:                                                        | 49384.7    | 0.003294              | 0.00324  | 0.003409    |        |            |               |            |            |               |
| Add:                                                          | 56428.8    | 0.004324              | 0.004253 | 0.004528    |        |            |               |            |            |               |
| Triad:                                                        | 56708.5    | 0.004283              | 0.004232 | 0.004332    |        |            |               |            |            |               |
| ------------------------------------------------------------- |            |                       |          |             |        |            |               |            |            |               |
| Solution                                                      | Validates: | avg                   | error    | less        | than   | 1e-13      | on            | all        | three      | arrays        |
| ------------------------------------------------------------- |            |                       |          |             |        |            |               |            |            |               |
#+END_SRC

Output of [[https://github.com/philipturner/applegpuinfo.git][GPUInfo]]
#+BEGIN_SRC
Build of product 'gpuinfo' complete! (38.30s)
GPU name: Apple M1
GPU vendor: Apple
GPU core count: 8
GPU clock frequency: 1.278 GHz
GPU bandwidth: 68.3 GB/s
GPU FLOPS: 2.617 TFLOPS
GPU IPS: 1.309 TIPS
GPU system level cache: 8 MB
GPU memory: 8 GB
GPU family: Apple 7
#+END_SRC
